<html><head><meta charSet="utf-8"/><title data-react-helmet="true">响应 · WorkerA 1.1 文档  · 看云</title><meta data-react-helmet="true" name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no"/><link rel="stylesheet" href="asset/website.css"/></head><body><div id="main"><div class="root"><div class="window-container"><div class="window-head"><div class="toolbar"><a class="title" href=".">WorkerA 1.1 文档</a><div class="extra"></div></div></div><div class="progress"><div style="width:68.42105263157895%" class="progress-bar"></div></div><div class="window-body"><div class="sidebar"><div class="sidebar-selector"><div class="item active"><i class="icon content"></i>目录</div><div class="item"><i class="icon search"></i>搜索</div></div><div class="sidebar-body"><div class="catalog-body active"><ul><li class=""><div class="wholerow"></div><i class="icon"></i><a href="前言.html" class="text">前言</a></li><li class=""><div class="wholerow"></div><i class="icon"></i><a href="版本说明.html" class="text">版本说明</a></li><li class=""><div class="wholerow"></div><i class="icon"></i><a href="旧版本升级.html" class="text">旧版本升级</a></li><li class=""><div class="wholerow"></div><i class="icon"></i><a href="框架性能.html" class="text">框架性能</a></li><li class=""><div class="wholerow"></div><i class="icon"></i><a href="框架结构说明.html" class="text">目录结构、程序架构</a></li><li class=""><div class="wholerow"></div><i class="icon"></i><a href="配置、安装.html" class="text">配置、安装</a></li><li class="open"><div class="wholerow"></div><i class="icon caret down"></i><a href="基本使用.html" class="text">基本使用</a><ul><li class=""><div class="wholerow"></div><i class="icon"></i><a href="开始.html" class="text">开始</a></li><li class=""><div class="wholerow"></div><i class="icon"></i><a href="路由.html" class="text">路由</a></li><li class=""><div class="wholerow"></div><i class="icon"></i><a href="控制器.html" class="text">控制器</a></li><li class=""><div class="wholerow"></div><i class="icon"></i><a href="中间件.html" class="text">中间件</a></li><li class=""><div class="wholerow"></div><i class="icon"></i><a href="请求.html" class="text">请求</a></li><li class="active"><div class="wholerow"></div><i class="icon"></i><a href="响应.html" class="text">响应</a></li></ul></li><li class=""><div class="wholerow"></div><i class="icon"></i><a href="异常处理.html" class="text">异常处理</a></li><li class=""><div class="wholerow"></div><i class="icon caret right"></i><a href="数据库.html" class="text">数据库</a><ul><li class=""><div class="wholerow"></div><i class="icon"></i><a href="数据库配置.html" class="text">数据库配置</a></li><li class=""><div class="wholerow"></div><i class="icon"></i><a href="查询构造器.html" class="text">查询构造器</a></li><li class=""><div class="wholerow"></div><i class="icon"></i><a href="模型.html" class="text">模型</a></li><li class=""><div class="wholerow"></div><i class="icon"></i><a href="Redis.html" class="text">Redis</a></li></ul></li></ul></div><div class="search-body"><div class="search-form"><form class="ui form"><div class="ui small fluid icon input"><input type="text" placeholder="请输入搜索关键词..."/><i class="search icon"></i></div></form></div><div class="search-result"><div class="blankslate"><i class="icon search"></i><p>暂无相关搜索结果！</p></div></div></div></div><div class="sidebar-copyright">本文档使用 <a href="http://www.kancloud.cn" target="_blank">看云</a> 构建</div></div><div class="workspace"><div class="article-wrap"><div class="article"><div class="article-head"><div class="left floated tools"><a class="item icon"><i class="icon align justify"></i></a></div><div class="right floated tools"></div><h1>响应</h1></div><div class="article-body"><p>目录</p>
<div class="markdown-toc"><ul><ul><li><a href="#_4">返回响应</a></li><li><a href="#_8">响应返回值</a></li><ul><li><a href="#_10">数组、对象</a></li><li><a href="#_14">字符串</a></li><li><a href="#_18">闭包</a></li></ul><li><a href="#header_22">header</a></li><li><a href="#redirect_66">redirect</a></li><li><a href="#_86">响应压缩编码</a></li></ul></ul></div><h2 data-line="4" class="line"><a id="_4"></a>返回响应</h2>
<p>你可以在路由闭包或控制器方法中返回响应数据。框架会将响应数据构建成 HTTP 响应返回给客户端。</p>
<h2 data-line="8" class="line"><a id="_8"></a>响应返回值</h2>
<h3 data-line="10" class="line"><a id="_10"></a>数组、对象</h3>
<p>当返回数组、对象时，框架会将返回值编码为 json 数据作为 HTTP 响应主体返回给用户。</p>
<h3 data-line="14" class="line"><a id="_14"></a>字符串</h3>
<p>当返回字符串时，框架会原封不动的将字符串作为 HTTP 响应主体返回给用户。</p>
<h3 data-line="18" class="line"><a id="_18"></a>闭包</h3>
<p>返回闭包时框架会在构建 HTTP Response 时执行闭包。默认以空字符串作为 HTTP 响应主体返回给用户。</p>
<h2 data-line="22" class="line"><a id="header_22"></a>header</h2>
<p>WorkerF\Http\Response 类的 header($headers) 方法可以为 HTTP 响应添加首部信息。</p>
<p>例子：</p>
<pre><code class="language-php">namespace App\Controller; 
use App\Controller\Controller;  

use WorkerF\Http\Response;

class TestController extends Controller
{
    public function test()
    {
    	// 为 HTTP 响应添加首部
		Response::header(&#x27;Content-Type: text/plain&#x27;);
        return &#x27;some data&#x27;;
    }
}
</code></pre>
<p>你也可以一传入一个数组添加多个首部：</p>
<pre><code class="language-php">namespace App\Controller; 
use App\Controller\Controller;  

use WorkerF\Http\Response;

class TestController extends Controller
{
    public function test()
    {
    	$headers = [
        	&#x27;Content-Type: text/plain&#x27;,
            &#x27;Content-Encoding: gzip&#x27;,
        ];
		Response::header();
        return &#x27;some data&#x27;;
    }
}
</code></pre>
<h2 data-line="66" class="line"><a id="redirect_66"></a>redirect</h2>
<p>WorkerF\Http\Response 类的 redirect($path) 方法提供了一个底层的 URL 重定向功能，WorkerF\Http\Route::redirect() 方法就是基于此方法。</p>
<p>同样，redirect 方法的返回值也需要被路由闭包或控制器方法返回才有效。</p>
<pre><code class="language-php">namespace App\Controller; 
use App\Controller\Controller;  

use WorkerF\Http\Response;

class TestController extends Controller
{
    public function test()
    {
		// URL 重定向，必须返回才有效
        return Response::redirect(&#x27;http://www.test.com&#x27;);;
    }
}
</code></pre>
<h2 data-line="86" class="line"><a id="_86"></a>响应压缩编码</h2>
<p>不同于 apache 和 nginx 的环境，HTTP 响应主体的压缩编码需要框架来做。WorkerA 实现了对 HTTP 响应主体的编码功能，支持 gzip 和 deflate 编码格式。</p>
<p>压缩编码的配置在配置文件 config/app.php 中：</p>
<pre><code class="language-php">&#x27;compress&#x27; =&gt; [
		// 编码格式，如果无需编码，设置为 &#x27;&#x27;
        &#x27;encoding&#x27;     =&gt; &#x27;gzip&#x27;, 
        // 压缩等级，从 1 到 9
        &#x27;level&#x27;        =&gt; &#x27;5&#x27;,
        // 接受压缩的内容，其他类型不会被压缩
        &#x27;content_type&#x27; =&gt; [
            &#x27;application/json&#x27;,
            &#x27;text/html&#x27;,
        ],
    ],

</code></pre>
 </div><div class="article-navigation"><span class="prev">上一篇：<a href="请求.html">请求</a></span><span class="next">下一篇：<a href="异常处理.html">异常处理</a></span></div></div></div></div></div></div></div></div><script src="asset/website.js"></script><script src="asset/plugins/highlight/index.js"></script><script type="application/payload+json">{"config":{"plugins":["highlight"],"price":0,"name":"wazsmwazsm/workera","sha":"0394c7aad780584659700053d4efaba1f4d43a76","title":"WorkerA 1.1 文档","id":70629},"catalog":[{"id":"前言.html","name":"前言.md","title":"前言","depth":1},{"id":"版本说明.html","name":"版本说明.md","title":"版本说明","depth":1},{"id":"旧版本升级.html","name":"旧版本升级.md","title":"旧版本升级","depth":1},{"id":"框架性能.html","name":"框架性能.md","title":"框架性能","depth":1},{"id":"框架结构说明.html","name":"框架结构说明.md","title":"目录结构、程序架构","depth":1},{"id":"配置、安装.html","name":"配置、安装.md","title":"配置、安装","depth":1},{"id":"基本使用.html","name":"基本使用.md","title":"基本使用","depth":1,"children":[{"id":"开始.html","name":"开始.md","title":"开始","depth":2},{"id":"路由.html","name":"路由.md","title":"路由","depth":2},{"id":"控制器.html","name":"控制器.md","title":"控制器","depth":2},{"id":"中间件.html","name":"中间件.md","title":"中间件","depth":2},{"id":"请求.html","name":"请求.md","title":"请求","depth":2},{"id":"响应.html","name":"响应.md","title":"响应","depth":2}]},{"id":"异常处理.html","name":"异常处理.md","title":"异常处理","depth":1},{"id":"数据库.html","name":"数据库.md","title":"数据库","depth":1,"children":[{"id":"数据库配置.html","name":"数据库配置.md","title":"数据库配置","depth":2},{"id":"查询构造器.html","name":"查询构造器.md","title":"查询构造器","depth":2},{"id":"模型.html","name":"模型.md","title":"模型","depth":2},{"id":"Redis.html","name":"Redis.md","title":"Redis","depth":2}]}],"article":{"id":"响应.html","name":"响应.md","title":"响应","content":"目录\n\n[TOC]\n\n## 返回响应\n\n你可以在路由闭包或控制器方法中返回响应数据。框架会将响应数据构建成 HTTP 响应返回给客户端。\n\n## 响应返回值\n\n### 数组、对象\n\n当返回数组、对象时，框架会将返回值编码为 json 数据作为 HTTP 响应主体返回给用户。\n\n### 字符串\n\n当返回字符串时，框架会原封不动的将字符串作为 HTTP 响应主体返回给用户。\n\n### 闭包\n\n返回闭包时框架会在构建 HTTP Response 时执行闭包。默认以空字符串作为 HTTP 响应主体返回给用户。\n\n## header\n\nWorkerF\\Http\\Response 类的 header($headers) 方法可以为 HTTP 响应添加首部信息。\n\n例子：\n```php\nnamespace App\\Controller; \nuse App\\Controller\\Controller;  \n\nuse WorkerF\\Http\\Response;\n\nclass TestController extends Controller\n{\n    public function test()\n    {\n    \t// 为 HTTP 响应添加首部\n\t\tResponse::header('Content-Type: text/plain');\n        return 'some data';\n    }\n}\n```\n\n你也可以一传入一个数组添加多个首部：\n```php\nnamespace App\\Controller; \nuse App\\Controller\\Controller;  \n\nuse WorkerF\\Http\\Response;\n\nclass TestController extends Controller\n{\n    public function test()\n    {\n    \t$headers = [\n        \t'Content-Type: text/plain',\n            'Content-Encoding: gzip',\n        ];\n\t\tResponse::header();\n        return 'some data';\n    }\n}\n```\n\n\n## redirect\nWorkerF\\Http\\Response 类的 redirect($path) 方法提供了一个底层的 URL 重定向功能，WorkerF\\Http\\Route::redirect() 方法就是基于此方法。\n\n同样，redirect 方法的返回值也需要被路由闭包或控制器方法返回才有效。\n```php\nnamespace App\\Controller; \nuse App\\Controller\\Controller;  \n\nuse WorkerF\\Http\\Response;\n\nclass TestController extends Controller\n{\n    public function test()\n    {\n\t\t// URL 重定向，必须返回才有效\n        return Response::redirect('http://www.test.com');;\n    }\n}\n```\n\n## 响应压缩编码\n\n不同于 apache 和 nginx 的环境，HTTP 响应主体的压缩编码需要框架来做。WorkerA 实现了对 HTTP 响应主体的编码功能，支持 gzip 和 deflate 编码格式。\n\n压缩编码的配置在配置文件 config/app.php 中：\n\n```php\n'compress' => [\n\t\t// 编码格式，如果无需编码，设置为 ''\n        'encoding'     => 'gzip', \n        // 压缩等级，从 1 到 9\n        'level'        => '5',\n        // 接受压缩的内容，其他类型不会被压缩\n        'content_type' => [\n            'application/json',\n            'text/html',\n        ],\n    ],\n\n```"},"options":{"plugins_host":null,"context":"website","base":"./","features":["search","internal_link"]},"style":""}</script><script type="text/javascript">kancloud.bootstrap();</script></body></html>